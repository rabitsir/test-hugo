{{/* 获取参数，设置默认值 */}}
{{ $bvid := .Get "bvid" | default (.Get 0) }}
{{ $page := .Get "page" | default 1 }}
{{ $quality := .Get "quality" | default 1 }}
{{ $autoplay := .Get "autoplay" | default 0 }}
{{ $danmaku := .Get "danmaku" | default 1 }}
{{ $width := .Get "width" | default "100%" }}
{{ $height := .Get "height" | default "400px" }}

{{/* 如果没有提供bvid，显示错误 */}}
{{ if not $bvid }}
<div style="color: red; padding: 20px; border: 2px solid red;">
    <strong>错误：</strong>请提供BV号，例如：{{ `{{<bilibili BV1xx411c7mD>}}` }}
</div>
{{ else }}
{{/* 构建URL */}}
{{ $src := printf "https://player.bilibili.com/player.html?bvid=%s&page=%s&high_quality=%s&autoplay=%s&danmaku=%s"
$bvid $page $quality $autoplay $danmaku }}

{{/* 响应式容器 */}}
<div class="bilibili-player"
    style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin: 20px 0;">
    <iframe src="{{ $src }}" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"
        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
    </iframe>
</div>
{{ end }}